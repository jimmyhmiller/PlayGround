{
  "name": "Flask Windows Demo",
  "description": "Light Table-style independent windows - each pane is a separate draggable window",
  "layout": {
    "type": "window-group",
    "scope": "flask",
    "windows": [
      {
        "title": "Flask Server",
        "x": 20,
        "y": 20,
        "width": 200,
        "height": 120,
        "widget": {
          "type": "layout",
          "direction": "vertical",
          "gap": 4,
          "children": [
            {
              "type": "process-runner",
              "props": {
                "id": "flask-server",
                "command": "./venv/bin/python",
                "args": ["app.py"],
                "cwd": "examples/flask-app",
                "title": "Server",
                "startLabel": "Start",
                "stopLabel": "Stop",
                "showOutput": false
              }
            },
            {
              "type": "file-loader",
              "props": {
                "files": ["examples/flask-app/app.py", "examples/flask-app/models.py"],
                "channel": "$scope.routes",
                "transform": "(content, filePath, allFiles) => { if (!filePath.endsWith('app.py')) return null; const modelsContent = allFiles && allFiles[1] ? allFiles[1].content : ''; const routes = []; const lines = content.split('\\n'); let i = 0; while (i < lines.length) { const line = lines[i]; const match = line.match(/@app\\.route\\(['\"]([^'\"]+)['\"](?:,\\s*methods=\\[([^\\]]+)\\])?\\)/); if (match) { const path = match[1]; const methods = match[2] ? match[2].replace(/['\"/]/g, '').split(',').map(m => m.trim()) : ['GET']; let codeEnd = i; let template = null; let usesTask = false; let usesNote = false; for (let j = i + 1; j < lines.length; j++) { if (lines[j].match(/^@app\\.route|^if __name__/)) { codeEnd = j - 1; break; } if (j === lines.length - 1) codeEnd = j; const tmplMatch = lines[j].match(/render_template\\(['\"]([^'\"]+)['\"]/); if (tmplMatch) template = 'examples/flask-app/templates/' + tmplMatch[1]; if (lines[j].includes('Task')) usesTask = true; if (lines[j].includes('Note')) usesNote = true; } const code = lines.slice(i, codeEnd + 1).join('\\n'); let modelCode = ''; if (modelsContent && (usesTask || usesNote)) { const modelLines = modelsContent.split('\\n'); let inClass = false; let className = ''; let classStart = -1; for (let k = 0; k < modelLines.length; k++) { const classMatch = modelLines[k].match(/^class (Task|Note)/); if (classMatch) { if (inClass && ((className === 'Task' && usesTask) || (className === 'Note' && usesNote))) { modelCode += modelLines.slice(classStart, k).join('\\n') + '\\n\\n'; } inClass = true; className = classMatch[1]; classStart = k; } } if (inClass && ((className === 'Task' && usesTask) || (className === 'Note' && usesNote))) { let endIdx = modelLines.length; for (let k = classStart + 1; k < modelLines.length; k++) { if (modelLines[k].match(/^class |^# Seed|^Task\\(|^Note\\(/)) { endIdx = k; break; } } modelCode += modelLines.slice(classStart, endIdx).join('\\n'); } } routes.push({ id: path + methods[0], path, methods, code, template, modelCode: modelCode.trim(), file: filePath }); } i++; } return routes; }"
              }
            }
          ]
        }
      },
      {
        "title": "Routes",
        "x": 20,
        "y": 160,
        "width": 200,
        "height": 400,
        "widget": {
          "type": "selector",
          "props": {
            "subscribePattern": "loaded.$scope.routes",
            "dataPath": "0.data",
            "labelTemplate": "${methods} ${path}",
            "idKey": "id",
            "channel": "$scope.route",
            "direction": "vertical"
          }
        }
      },
      {
        "title": "Controller",
        "x": 240,
        "y": 20,
        "width": 450,
        "height": 280,
        "widget": {
          "type": "code-block",
          "props": {
            "subscribePattern": "selection.$scope.route",
            "codeKey": "code",
            "lineNumbers": true,
            "language": "Python"
          }
        }
      },
      {
        "title": "Model",
        "x": 240,
        "y": 320,
        "width": 450,
        "height": 280,
        "widget": {
          "type": "code-block",
          "props": {
            "subscribePattern": "selection.$scope.route",
            "codeKey": "modelCode",
            "lineNumbers": true,
            "language": "Python"
          }
        }
      },
      {
        "title": "Template",
        "x": 710,
        "y": 20,
        "width": 450,
        "height": 280,
        "widget": {
          "type": "code-block",
          "props": {
            "filePattern": "selection.$scope.route",
            "fileKey": "template",
            "lineNumbers": true,
            "language": "HTML"
          }
        }
      },
      {
        "title": "Live Preview",
        "x": 710,
        "y": 320,
        "width": 450,
        "height": 350,
        "widget": {
          "type": "webview",
          "props": {
            "url": "http://localhost:5001",
            "subscribePattern": "selection.$scope.route",
            "pathKey": "path"
          }
        }
      }
    ]
  }
}
